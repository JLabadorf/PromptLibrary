
**Environment Context (Python to Stored Procedure Conversion)**

*   **Source Language:** Python
*   **Target Language:** SQL Stored Procedure
*   **SQL Flavor:** [Specify the exact SQL environment for your stored procedure.  e.g., PostgreSQL, SQL Server, MySQL, Oracle, etc. This is critical because stored procedure syntax varies a lot.]
*   **Conversion Goal:** [Briefly describe what the Python code does and what you want the stored procedure to achieve. What is the overall purpose of this conversion?]

**Query Creation Workflow (Python to Stored Procedure Conversion)**

**Cycle Overview**

**1. Start Phase: Understanding the Python Code and Desired Stored Procedure**

*   **Please provide the Python code snippet that you want to convert to a stored procedure.** Paste your Python code here:
    ```python
    [Insert your Python code here]
    ```
*   **Clarifying Questions to understand the Python code and conversion requirements:**
    *   **Can you explain what the Python code does step-by-step?**  What is the logic and functionality?
    *   **Does this Python code interact with a database?**  If so, what database, tables, and columns are involved?  How does it interact (read, write, update, etc.)?
    *   **What are the inputs to this Python code?** (e.g., are there any parameters or data it receives?)
    *   **What are the outputs of this Python code?** (e.g., what results does it produce? Does it return any values or modify data?)
    *   **Why do you want to convert this Python code to a stored procedure?** (e.g., performance improvement, data security, moving logic closer to the database, etc.)
    *   **Are there any specific performance requirements for the stored procedure?**
    *   **Are you aware of any Python libraries used in this code that might not have direct equivalents in SQL?**

**2. Refining Phase: Analyzing Python Logic and Planning SQL Stored Procedure Structure**

*   **Analyze the Python code:** We will break down the Python code to understand its logic, control flow (loops, conditionals), data manipulations, and database interactions.
*   **Identify SQL Equivalents:**  We will determine the best way to translate Python constructs into SQL stored procedure syntax. This may involve:
    *   Mapping Python variables to SQL variables.
    *   Translating Python loops into SQL loops (e.g., `WHILE` loops, cursors, or set-based operations if possible).
    *   Converting Python conditional statements (`if/else`) to SQL `IF/ELSE` or `CASE` statements.
    *   Translating Python database operations (if any) to equivalent SQL commands within the stored procedure.
    *   Handling any data transformations or calculations in Python using SQL functions and operators.
*   **Design the Stored Procedure Structure:** We will plan the structure of the stored procedure, including:
    *   Input parameters:  Based on the inputs of the Python code.
    *   Output parameters or result sets: Based on the outputs of the Python code.
    *   Local variables within the stored procedure.
    *   SQL statements to implement the logic.
    *   Error handling (if needed).

**3. Creating the Stored Procedure (The "QUERY" Phase for Code Conversion)**

*   **Upon receiving the prompt "QUERY" from you:**
    *   Construct the SQL stored procedure code based on our analysis and planning.
    *   Adhere strictly to the specified SQL Flavor syntax for stored procedures.
    *   Include comments in the stored procedure code to explain the logic and how it corresponds to the original Python code.
    *   If there are any parts of the Python code that are difficult or impossible to directly translate to SQL stored procedures, we will highlight these limitations and suggest alternative approaches if possible.
    *   Present the generated SQL stored procedure code to you for review, testing, and deployment.

**Useful Information (Python to Stored Procedure Conversion)**

*   **Direct one-to-one conversion is not always possible or ideal.** Python and SQL are different languages with different strengths. We aim for functional equivalence, not necessarily line-by-line translation.
*   **Stored procedures in SQL are typically best suited for database-centric operations.** If the Python code involves significant logic outside of database interactions (e.g., complex external API calls, file processing, etc.), a direct stored procedure conversion might not be the most appropriate solution. We can discuss alternatives if this is the case.
*   **Performance is often a key reason for using stored procedures.** We will try to write the stored procedure in a way that is efficient and leverages the capabilities of your SQL database.

**Available "Tables" (for Python to Stored Procedure Conversion - Metaphorical)**

*   **Python Code:** The input source code.
*   **SQL Flavor Documentation:** We will refer to the documentation for your specific SQL database to ensure correct stored procedure syntax and available functions.
*   **Database Schema (if applicable):**  Knowledge of the database schema involved is crucial if the Python code interacts with a database.

**Notes (Python to Stored Procedure Conversion)**

*   This is a more complex task than just writing SQL queries.  It's a code translation and software engineering task.
*   The complexity and feasibility of the conversion will depend heavily on the nature and complexity of the Python code you provide.
*   We will work iteratively and communicate clearly throughout the process.

